import sqlite3
import os

def insert_suspect_stocks_data():
    """suspect_stocks.dbì— ë°ì´í„°ë¥¼ ì‚½ì…í•©ë‹ˆë‹¤."""
    
    db_path = "DB/suspect_stocks.db"
    
    if not os.path.exists(db_path):
        print(f"âŒ {db_path} íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
        return
    
    # ì‚½ì…í•  ë°ì´í„°
    data = [
        ("ì—ë””ìŠ¨EV", "2021ë…„", "ìŒìš©ì°¨ ì¸ìˆ˜ ê¸°ëŒ€ê°", "ìŒìš©ì°¨ ì¸ìˆ˜ ì¶”ì§„ ë°œí‘œ í›„ ì£¼ê°€ ê¸‰ë“±. ì´í›„ ì¸ìˆ˜ ë¬´ì‚° ë° ìƒì¥íì§€ ìœ„ê¸°.", "ì•½ 3ê°œì›”", "ê°œì¸ íˆ¬ìì ì¤‘ì‹¬ ë§¤ìˆ˜", 1000, 13000, 0),
        ("ì‚¼ì²œë¦¬ìì „ê±°", "2021ë…„", "ìì „ê±° ìˆ˜ìš” ì¦ê°€ ê¸°ëŒ€ê°", "ì½”ë¡œë‚˜19ë¡œ ì¸í•œ ìì „ê±° ìˆ˜ìš” ì¦ê°€ ê¸°ëŒ€ê°ìœ¼ë¡œ ì£¼ê°€ ìƒìŠ¹.", "ì•½ 2ê°œì›”", "ê¸°ê´€ íˆ¬ìì ë§¤ìˆ˜ ì¦ê°€", 5000, 20000, 10000),
        ("ìŒë°©ìš¸", "2022ë…„", "ìŒìš©ì°¨ ì¸ìˆ˜ ê¸°ëŒ€ê°", "ìŒìš©ì°¨ ì¸ìˆ˜ ì˜í–¥ì„œ ì œì¶œ ë°œí‘œ í›„ ì£¼ê°€ ê¸‰ë“±. ì´í›„ ì¸ìˆ˜ ë¬´ì‚°.", "ì•½ 1ê°œì›”", "ê°œì¸ íˆ¬ìì ì¤‘ì‹¬ ë§¤ìˆ˜", 1500, 4500, 1200),
        ("ë£¨ë³´", "2020ë…„", "M&A ê¸°ëŒ€ê°", "ì¸ìˆ˜í•©ë³‘ ë£¨ë¨¸ í™•ì‚°ìœ¼ë¡œ ì£¼ê°€ ê¸‰ë“±. ì´í›„ ì£¼ê°€ ê¸‰ë½.", "ì•½ 2ê°œì›”", "ì™¸êµ­ì¸ íˆ¬ìì ë§¤ìˆ˜ ì¦ê°€", 2000, 16000, 3000),
        ("ë¦¬íƒ€ì›Œí…", "2020ë…„", "ë…¹ìƒ‰ì„±ì¥ í…Œë§ˆì£¼", "ì •ë¶€ì˜ ë…¹ìƒ‰ì„±ì¥ ì •ì±… ìˆ˜í˜œ ê¸°ëŒ€ê°ìœ¼ë¡œ ì£¼ê°€ ìƒìŠ¹.", "ì•½ 1.5ê°œì›”", "ê¸°ê´€ íˆ¬ìì ë§¤ìˆ˜ ì¦ê°€", 3000, 12000, 4000),
        ("í—¬ë¦¬ì•„í…", "2020ë…„", "ë°”ì´ì˜¤ í…Œë§ˆì£¼", "ì‹ ì•½ ê°œë°œ ê´€ë ¨ ë£¨ë¨¸ í™•ì‚°ìœ¼ë¡œ ì£¼ê°€ ê¸‰ë“±. ì´í›„ ì£¼ê°€ ê¸‰ë½.", "ì•½ 2ê°œì›”", "ê°œì¸ íˆ¬ìì ì¤‘ì‹¬ ë§¤ìˆ˜", 4000, 28000, 5000),
        ("ì§€ì´ì—”ì—í”„", "2020ë…„", "M&A ê¸°ëŒ€ê°", "ì¸ìˆ˜í•©ë³‘ ë£¨ë¨¸ í™•ì‚°ìœ¼ë¡œ ì£¼ê°€ ê¸‰ë“±. ì´í›„ ì£¼ê°€ ê¸‰ë½.", "ì•½ 1.5ê°œì›”", "ì™¸êµ­ì¸ íˆ¬ìì ë§¤ìˆ˜ ì¦ê°€", 3500, 17000, 4500),
        ("ì—ì´ì¹˜ì—˜ë¹„", "2021ë…„", "ì‹ ì•½ ê°œë°œ ê¸°ëŒ€ê°", "ë¦¬ë³´ì„¸ë¼ë‹™ì˜ ì„ìƒ ê²°ê³¼ ë°œí‘œ í›„ ì£¼ê°€ ê¸‰ë“±.", "ì•½ 3ê°œì›”", "ê¸°ê´€ íˆ¬ìì ë§¤ìˆ˜ ì¦ê°€", 20000, 120000, 60000),
        ("ì”¨í‹°ì”¨ë°”ì´ì˜¤", "2021ë…„", "ë°”ì´ì˜¤ í…Œë§ˆì£¼", "ì‹ ì•½ ê°œë°œ ê´€ë ¨ ì†Œì‹ìœ¼ë¡œ ì£¼ê°€ ê¸‰ë“±. ì´í›„ ì£¼ê°€ ê¸‰ë½.", "ì•½ 2ê°œì›”", "ê°œì¸ íˆ¬ìì ì¤‘ì‹¬ ë§¤ìˆ˜", 6000, 24000, 7000),
        ("ë„¥ìŠ¤íŠ¸ì‚¬ì´ì–¸ìŠ¤", "2021ë…„", "ë°”ì´ì˜¤ ì‚¬ì—… ì§„ì¶œ ë°œí‘œ", "ìíšŒì‚¬ì¸ ë°”ì´ì˜¤ê¸°ì—… ì¸ìˆ˜ ë°œí‘œ í›„ ì£¼ê°€ ê¸‰ë“±. ì´í›„ ì£¼ê°€ ê¸‰ë½.", "ì•½ 2.5ê°œì›”", "ì™¸êµ­ì¸ íˆ¬ìì ë§¤ìˆ˜ ì¦ê°€", 5000, 25000, 6000),
    ]
    
    # DB ì—°ê²°
    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()
    
    # ê¸°ì¡´ ë°ì´í„° ì‚­ì œ (ìƒˆë¡œ ì‹œì‘)
    cursor.execute("DELETE FROM suspect_stocks")
    print("ğŸ—‘ï¸ ê¸°ì¡´ ë°ì´í„°ë¥¼ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.")
    
    # ë°ì´í„° ì‚½ì…
    cursor.executemany('''
        INSERT INTO suspect_stocks (
            stock_name, suspected_period, theme_reason, main_issue, 
            active_duration, buy_side_pattern, price_3y_ago, price_peak, price_current
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
    ''', data)
    
    # ë³€ê²½ì‚¬í•­ ì €ì¥
    conn.commit()
    
    # ì‚½ì…ëœ ë°ì´í„° í™•ì¸
    cursor.execute("SELECT COUNT(*) FROM suspect_stocks")
    count = cursor.fetchone()[0]
    
    print(f"âœ… {count}ê°œì˜ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤.")
    
    # ì‚½ì…ëœ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°
    cursor.execute("SELECT id, stock_name, suspected_period, theme_reason FROM suspect_stocks LIMIT 5")
    preview_data = cursor.fetchall()
    
    print("\nğŸ“‹ ì‚½ì…ëœ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°:")
    for row in preview_data:
        print(f"  {row[0]}. {row[1]} ({row[2]}) - {row[3]}")
    
    if count > 5:
        print(f"  ... ì™¸ {count - 5}ê°œ ë”")
    
    # í†µê³„ ì •ë³´
    cursor.execute("SELECT suspected_period, COUNT(*) FROM suspect_stocks GROUP BY suspected_period")
    period_stats = cursor.fetchall()
    
    print("\nğŸ“Š ì—°ë„ë³„ í†µê³„:")
    for period, cnt in period_stats:
        print(f"  - {period}: {cnt}ê°œ")
    
    conn.close()
    print(f"\nâœ… ì‘ì—… ì™„ë£Œ!")

if __name__ == "__main__":
    insert_suspect_stocks_data() 